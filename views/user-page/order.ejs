<div class="container mt-5">
  <h2 class="text-center mb-4">My Order</h2>
  <% include('../partials/messages') %>
  <div class="row">
    <div class="col-md-12">
      <% if (orders.length === 0) { %>
      <div class="alert alert-info" role="alert">
        There are no orders available.
      </div>
      <% } else { %>
      <table class="table table-striped">
        <thead class="table-dark">
          <tr>
            <th scope="col">No</th>
            <th scope="col">Product Name</th>
            <th scope="col">Ordered Time</th>
            <th scope="col">Ordered Status</th>
            <th scope="col">Ordered Finish Time</th>
            <th scope="col">Price</th>
            <th scope="col">Quantity</th>
            <th scope="col">Image</th>
            <th scope="col">Action</th>
          </tr>
        </thead>
        <tbody>
          <% orders.forEach((order, index) => { %> <% order.items.forEach((item,
          itemIndex) => { %>
          <tr>
            <th scope="row"><%= index + 1 %></th>
            <td><%= item.productName %></td>
            <td><%= order.orderDate.toLocaleString() %></td>
            <td class="fw-bold"><%= order.orderStatus %></td>
            <td><%= order.orderFinish %></td>
            <td>$ <%= item.totalPrice %></td>
            <td><%= item.quantity %></td>
            <td>
              <img
                src="<%= item.image %>"
                alt="Product Image"
                style="max-width: 100px"
              />
            </td>
            <td>
              <div class="d-flex flex-column">
                <form method="POST" action="/finish?_method=PUT">
                  <input type="hidden" name="_id" value="<%= order._id %>" />
                  <button
                    type="submit"
                    class="btn btn-primary fw-bold mb-2"
                    style="width: 80px"
                    onclick="return confirm('Mark this order as done?')"
                  >
                    Finish
                  </button>
                </form>
                <form method="POST" action="/order?_method=DELETE">
                  <input type="hidden" name="_id" value="<%= order._id %>" />
                  <button
                    type="submit"
                    class="btn btn-danger fw-bold"
                    style="width: 80px"
                    onclick="return confirm('Mark this order as done?')"
                  >
                    Delete
                  </button>
                </form>
              </div>
            </td>
          </tr>
          <% }) %> <% }) %>
        </tbody>
      </table>
      <% } %>
    </div>
  </div>
</div>
